import{l as Z,a as R,c as ge,b as fe,d as ye,e as we,u as ee,m as le,h as ke}from"./moment.cbf9456f.js";import{f as x,a as v,b as k,d as l,h as xe,G as re,r as L,i as Ce,w as D,o as G,g as N,j as s,k as Q,l as t,u as ce,m as r,n as S,q as u,t as F,p as $e,e as Ie,s as P,R as te,N as ne,v as be,x as Le,y as A,z as oe,A as ae,B as Be,F as Se,C as Fe,D as Pe,E as se}from"./index.43cffb43.js";import{_ as U}from"./plugin-vue_export-helper.21dcd24c.js";var ze="./assets/logo.8db43109.png";const qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Me=l("path",{d:"M315.27 33L96 304h128l-31.51 173.23a2.36 2.36 0 0 0 2.33 2.77h0a2.36 2.36 0 0 0 1.89-.95L416 208H288l31.66-173.25a2.45 2.45 0 0 0-2.44-2.75h0a2.42 2.42 0 0 0-1.95 1z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),De=[Me];var Ve=x({name:"FlashOutline",render:function(e,n){return v(),k("svg",qe,De)}});const Te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ee=xe('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M160 144h288"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M160 256h288"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M160 368h288"></path><circle cx="80" cy="144" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="80" cy="256" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="80" cy="368" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle>',6),Re=[Ee];var Ae=x({name:"List",render:function(e,n){return v(),k("svg",Te,Re)}});const Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ue=l("path",{d:"M208 432h-48a16 16 0 0 1-16-16V96a16 16 0 0 1 16-16h48a16 16 0 0 1 16 16v320a16 16 0 0 1-16 16z",fill:"currentColor"},null,-1),Ke=l("path",{d:"M352 432h-48a16 16 0 0 1-16-16V96a16 16 0 0 1 16-16h48a16 16 0 0 1 16 16v320a16 16 0 0 1-16 16z",fill:"currentColor"},null,-1),je=[Ue,Ke];var He=x({name:"Pause",render:function(e,n){return v(),k("svg",Ne,je)}});const Oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Qe=l("path",{d:"M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z",fill:"currentColor"},null,-1),Ge=[Qe];var Xe=x({name:"Play",render:function(e,n){return v(),k("svg",Oe,Ge)}});const Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},We=l("path",{d:"M112 64a16 16 0 0 1 16 16v136.43L360.77 77.11a35.13 35.13 0 0 1 35.77-.44c12 6.8 19.46 20 19.46 34.33v290c0 14.37-7.46 27.53-19.46 34.33a35.14 35.14 0 0 1-35.77-.45L128 295.57V432a16 16 0 0 1-32 0V80a16 16 0 0 1 16-16z",fill:"currentColor"},null,-1),Ye=[We];var Ze=x({name:"PlaySkipBack",render:function(e,n){return v(),k("svg",Je,Ye)}});const et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},tt=l("path",{d:"M400 64a16 16 0 0 0-16 16v136.43L151.23 77.11a35.13 35.13 0 0 0-35.77-.44C103.46 83.47 96 96.63 96 111v290c0 14.37 7.46 27.53 19.46 34.33a35.14 35.14 0 0 0 35.77-.45L384 295.57V432a16 16 0 0 0 32 0V80a16 16 0 0 0-16-16z",fill:"currentColor"},null,-1),nt=[tt];var ot=x({name:"PlaySkipForward",render:function(e,n){return v(),k("svg",et,nt)}});const at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},st=l("path",{d:"M232 416a23.88 23.88 0 0 1-14.2-4.68a8.27 8.27 0 0 1-.66-.51L125.76 336H56a24 24 0 0 1-24-24V200a24 24 0 0 1 24-24h69.75l91.37-74.81a8.27 8.27 0 0 1 .66-.51A24 24 0 0 1 256 120v272a24 24 0 0 1-24 24zm-106.18-80zm-.27-159.86z",fill:"currentColor"},null,-1),lt=l("path",{d:"M320 336a16 16 0 0 1-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81c0-19.38-4.66-37.94-14.25-56.73a16 16 0 0 1 28.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 0 1 320 336z",fill:"currentColor"},null,-1),rt=l("path",{d:"M368 384a16 16 0 0 1-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0 1 27.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 0 1-13.87 8z",fill:"currentColor"},null,-1),ct=l("path",{d:"M416 432a16 16 0 0 1-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1 1 27-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 0 1 416 432z",fill:"currentColor"},null,-1),ut=[st,lt,rt,ct];var it=x({name:"VolumeHigh",render:function(e,n){return v(),k("svg",at,ut)}});const dt={class:"user"},_t={class:"username"},pt=["src"],mt=x({__name:"user",setup(f){const e=re();ce();const n=L(!1),h=L(""),m=Ce(()=>e.isLogin);D(m,o=>{});const a=L("\u9A8C\u8BC1");G(async()=>{const{data:o}=await Z();!o.data.account||o.data.account.status==-10?e.isLogin=!1:(e.isLogin=!0,e.userInfo=o.data.profile)});async function C(o){return(await R({url:`http://120.48.115.17:3000/login/qr/check?key=${o}&timestamp=${Date.now()}`})).data}async function I(o=""){const p=await R({url:`http://120.48.115.17:3000/login/status?timestamp=${Date.now()}`,method:"post",data:{cookie:o}});console.log(p.data)}async function z(){n.value=!0;let o;I(e.cookie);const B=(await R({url:`http://120.48.115.17:3000/login/qr/key?timestamp=${Date.now()}`})).data.data.unikey,q=await R({url:`http://120.48.115.17:3000/login/qr/create?key=${B}&qrimg=true&timestamp=${Date.now()}`});h.value=q.data.data.qrimg,o=setInterval(async()=>{const y=await C(B);if(y.code===800&&(alert("\u4E8C\u7EF4\u7801\u5DF2\u8FC7\u671F,\u8BF7\u91CD\u65B0\u83B7\u53D6"),clearInterval(o)),y.code===803){clearInterval(o),alert("\u6388\u6743\u767B\u5F55\u6210\u529F");let w=await I(y.cookie);console.log(w),e.isLogin=!0,e.userInfo=w.data.profile,e.cookie=y.cookie}},3e3)}const V=async()=>{const o=await ye();console.log(o),e.qrKey=o.data.data.unikey,console.log(e.qrKey);const p=await we({key:e.qrKey,qrimg:!0});h.value=p.data.data.qrimg,console.log(p.data.data)},_=async()=>{const{data:o}=await ge({key:e.qrKey});if(console.log(o),a.value=o.message,o.code===803){a.value="\u767B\u5F55\u6210\u529F";let p=await Z();console.log(p),p.data.data.account.status==-10?e.isLogin=!1:(e.isLogin=!0,e.userInfo=p.data.data.profile),n.value=!1}else o.code===800&&V()},i=async()=>{const{data:o}=await fe();console.log(o),o.code===200&&(e.isLogin=!1,e.userInfo={},e.qrKey="")};return(o,p)=>{const B=r("n-button"),q=r("n-avatar"),y=r("n-popover"),w=r("n-card"),K=r("n-modal");return v(),k("div",dt,[m.value?Q("",!0):(v(),N(B,{key:0,quaternary:"",onClick:z},{default:s(()=>[S(" \u767B\u5F55 ")]),_:1})),m.value?(v(),N(y,{key:1,width:"trigger"},{trigger:s(()=>[l("div",null,[t(q,{round:"",size:24,src:u(e).userInfo.avatarUrl},null,8,["src"]),S(),l("span",_t,F(u(e).userInfo.nickname),1)])]),default:s(()=>[t(B,{size:"small",onClick:i},{default:s(()=>[S(" \u9000\u51FA\u767B\u5F55 ")]),_:1})]),_:1})):Q("",!0),t(K,{show:n.value,"onUpdate:show":p[0]||(p[0]=j=>n.value=j)},{default:s(()=>[t(w,{style:{width:"600px"},title:"\u767B\u5F55",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":s(()=>[S(" X ")]),footer:s(()=>[t(B,{size:"small",onClick:_},{default:s(()=>[S(F(a.value),1)]),_:1}),S(" "+F(a.value),1)]),default:s(()=>[l("img",{src:h.value,alt:""},null,8,pt)]),_:1})]),_:1},8,["show"])])}}});var vt=U(mt,[["__scopeId","data-v-337a8533"]]);const ht=f=>($e("data-v-58202a66"),f=f(),Ie(),f),gt={class:"music-header"},ft=ht(()=>l("span",{class:"title"},"\u7F51\u6613\u4E91\u97F3\u4E50",-1)),yt=x({__name:"index",setup(f){const e=ce(),n=h=>{if(h.key==="Enter"){if(console.log(e.currentRoute),e.currentRoute.value.path==="/music/search"){e.push({query:{keywords:h.target.value}});return}e.push({path:"/music/search",query:{keywords:h.target.value}})}};return(h,m)=>{const a=r("n-avatar"),C=r("n-icon"),I=r("n-input");return v(),k("div",gt,[t(a,{round:"",size:48,src:u(ze)},null,8,["src"]),S(),ft,t(I,{placeholder:"\u641C\u7D22",onKeyup:n},{prefix:s(()=>[t(C,{component:u(Ve)},null,8,["component"])]),_:1}),t(vt)])}}});var wt=U(yt,[["__scopeId","data-v-58202a66"]]);const kt={class:"left-menu"},xt=x({__name:"index",setup(f){const e=re(),n=L([]);D(()=>e.userInfo.userId,m=>{m&&ee(e.userInfo.userId).then(a=>{console.log(a.data.playlist)})}),G(()=>{e.userInfo.userId&&ee(e.userInfo.userId).then(m=>{m.data.playlist.forEach(a=>{n.value.push({label:()=>P(te,{to:{name:"songSheet",query:{id:a.id}}},{default:()=>a.name}),key:a.id,icon:()=>P("img",{src:a.coverImgUrl+"?param=40y40",class:"listcover"})})})})});const h=L([{label:()=>P(te,{to:{name:"mainPage",params:{}}},{default:()=>"\u4E3A\u6211\u63A8\u8350"}),key:"recommend"},{label:"\u6392\u884C\u699C",key:"rank"},{label:"\u6536\u85CF",key:"songList",children:n}]);return(m,a)=>{const C=r("n-menu");return v(),k("div",kt,[t(C,{options:h.value,indent:10},null,8,["options"])])}}});const Ct={class:"songList"},$t=x({__name:"playList",setup(f){const e=le(),n=L(!0),h=_=>_.id===e.songs[e.currentIndex].id?"current":"",m=({play:_})=>[{title:"\u5C01\u9762",key:"cover",width:80,render(i){return P("img",{src:i.cover,class:"songcover"})}},{title:"\u6807\u9898",key:"title"},{title:"\u6B4C\u624B",key:"singer"},{title:"\u65F6\u957F",key:"length",render(i){return P("span",ke(i.time).format("mm:ss"))}},{title:"\u64CD\u4F5C",key:"action",width:100,render(i){return[P(ne,{size:"small",onClick:()=>{_(i)}},{default:()=>"\u64AD\u653E"}),P(ne,{size:"small",onClick:()=>{z(i)}},{default:()=>"\u79FB\u9664"})]}}],a=L(e.songs),C=L(e.currentIndex);e.$subscribe((_,i)=>{a.value=i.songs,n.value=!1,setTimeout(()=>{n.value=!0},0)}),console.log(a.value),D(a,_=>{console.log(_)});const I=_=>{let i=a.value.findIndex(o=>o.id===_.id);C.value=i,e.currentIndex=i,console.log(i,a.value.length)},z=_=>{console.log(_);let i=a.value.findIndex(o=>o.id===_.id);a.value.splice(i,1),console.log(i,a.value.length)},V=m({play:I});return(_,i)=>{const o=r("n-data-table");return v(),k("div",Ct,[n.value?(v(),N(o,{key:0,columns:u(V),data:a.value,bordered:!1,"max-height":400,"row-class-name":h},null,8,["columns","data"])):Q("",!0)])}}});const It={class:"player"},bt=["src"],Lt={class:"control"},Bt={class:"vol"},St={class:"showMusicBox"},Ft={style:{"margin-right":"150px"}},Pt={style:{position:"relative"}},zt={class:"lyrics-container"},qt=x({__name:"player",setup(f){const e=le(),n=be({isPlaying:!1,active:!1,activeList:!1,currentTime:0,cover:"",name:"",length:0,progress:0,duration:0,volume:30,lyric:[],currentLine:-1,animationPlayState:"paused"}),{isPlaying:h,active:m,activeList:a,currentTime:C,cover:I,name:z,length:V,progress:_,duration:i,volume:o,lyric:p,currentLine:B,animationPlayState:q}=Le(n),y=L(e.songs[e.currentIndex]);G(()=>{w.value.volume=o.value/100,w.value.src=y.value.src,n.lyric=X(y.value.Lyric)}),D(y,d=>{console.log("currentSong",d),n.lyric=X(d.Lyric),console.log("lyric",n.lyric),T()}),e.$subscribe((d,c)=>{y.value=c.songs[c.currentIndex]});const w=L(null),K=d=>{if(n.currentTime=Math.floor(w.value.currentTime),n.progress=n.currentTime/n.duration*100,!p.value)return;for(let g=0;g<p.value.length;g++)if(g===p.value.length-1||C.value<p.value[g+1].time){B.value=g;break}const c=document.querySelector(".lyrics-container li.active");if(c){const g=document.querySelector(".lyrics-container ul");g.scrollTop=c.offsetTop-g.clientHeight/2+c.clientHeight}},j=d=>{n.duration=Math.floor(w.value.duration),console.log("durationchange",n.duration)},ue=()=>{console.log("ended")},T=()=>{n.isPlaying=!0,n.animationPlayState="running",se(()=>{w.value.play()})},ie=()=>{n.isPlaying=!1,n.animationPlayState="paused",se(()=>{w.value.pause()})},de=()=>{n.isPlaying=!n.isPlaying,n.isPlaying?T():ie()},_e=()=>{e.currentIndex==0?e.currentIndex=e.songs.length-1:e.currentIndex--,T()},pe=()=>{e.currentIndex==e.songs.length-1?e.currentIndex=0:e.currentIndex++,T()},H=d=>{const c=Math.floor(d/60),g=(d%60).toFixed(0);return`${c}:${g.toString().padStart(2,"0")}`},me=d=>H(d*n.duration/100);D(_,d=>{});const ve=()=>{let d=n.progress*n.duration/100;isNaN(d)||(w.value.currentTime=d)},he=d=>{w.value.volume=d/100},X=d=>d?d.split(`
`).map(g=>{const b=g.match(/^\[(\d{2}):(\d{2}\.\d{2,3})\](.*)/);if(b){const M=parseInt(b[1]),O=parseFloat(b[2]),E=b[3].trim();return{time:M*60+O,text:E}}else return null}).filter(g=>g!==null):void 0;return(d,c)=>{const g=r("n-image"),b=r("n-icon"),M=r("n-button"),O=r("n-button-group"),E=r("n-slider"),J=r("n-drawer-content"),W=r("n-drawer");return v(),k("div",It,[l("audio",{ref_key:"audio",ref:w,src:y.value.src,onTimeupdate:K,onDurationchange:j,onEnded:ue},null,40,bt),t(g,{width:"60",src:y.value.cover,onClick:c[0]||(c[0]=$=>m.value=!0),"preview-disabled":""},null,8,["src"]),l("span",null,F(y.value.title),1),l("div",Lt,[t(O,null,{default:s(()=>[t(M,{round:"",onClick:_e},{icon:s(()=>[t(b,null,{default:s(()=>[t(u(Ze))]),_:1})]),_:1}),t(M,{ghost:"",onClick:de},{icon:s(()=>[t(b,null,{default:s(()=>[oe(t(u(He),null,null,512),[[ae,u(h)]]),oe(t(u(Xe),null,null,512),[[ae,!u(h)]])]),_:1})]),_:1}),t(M,{round:"",onClick:pe},{icon:s(()=>[t(b,null,{default:s(()=>[t(u(ot))]),_:1})]),_:1})]),_:1}),l("span",null,F(H(u(C)))+" / "+F(H(u(i))),1),t(E,{value:u(_),"onUpdate:value":c[1]||(c[1]=$=>A(_)?_.value=$:null),min:0,max:100,step:.01,onDragend:ve,"format-tooltip":me},null,8,["value"]),l("div",Bt,[t(b,null,{default:s(()=>[t(u(it))]),_:1}),t(E,{value:u(o),"onUpdate:value":[c[2]||(c[2]=$=>A(o)?o.value=$:null),he],min:0,max:100,step:.01},null,8,["value"]),t(b,{onClick:c[3]||(c[3]=$=>a.value=!0)},{default:s(()=>[t(u(Ae))]),_:1})])]),t(W,{show:u(m),"onUpdate:show":c[4]||(c[4]=$=>A(m)?m.value=$:null),class:"lyric-drawer",placement:"top",to:"#my-music","mask-closable":!1,"show-mask":!1},{default:s(()=>[t(J,{title:"\u6B4C\u8BCD\u9875",closable:""},{default:s(()=>[l("div",St,[l("div",Ft,[l("div",Pt,[t(g,{width:"250",style:Be({animationPlayState:u(q)}),src:y.value.cover+"?param=350y350"},null,8,["style","src"])])]),l("div",zt,[l("ul",null,[(v(!0),k(Se,null,Fe(u(p),($,Y)=>(v(),k("li",{key:Y,class:Pe({active:u(B)===Y})},F($.text),3))),128))])])])]),_:1})]),_:1},8,["show"]),t(W,{show:u(a),"onUpdate:show":c[5]||(c[5]=$=>A(a)?a.value=$:null),width:502,placement:"right",to:"#my-music"},{default:s(()=>[t(J,{title:"\u64AD\u653E\u5217\u8868"},{default:s(()=>[t($t)]),_:1})]),_:1},8,["show"])])}}});var Mt=U(qt,[["__scopeId","data-v-c4efb8e4"]]);const Dt=x({__name:"index",setup(f){return(e,n)=>{const h=r("n-layout-header"),m=r("n-layout-sider"),a=r("RouterView"),C=r("n-layout-content"),I=r("n-layout"),z=r("n-layout-footer");return v(),N(I,{id:"my-music"},{default:s(()=>[t(h,{class:"music-header",style:{"background-color":"red"}},{default:s(()=>[t(wt)]),_:1}),t(I,{"has-sider":""},{default:s(()=>[t(m,{class:"music-left","content-style":"padding: 10px;","collapse-mode":"width"},{default:s(()=>[t(xt)]),_:1}),t(C,{class:"music-content","content-style":"padding: 24px;background-color: white"},{default:s(()=>[t(a)]),_:1})]),_:1}),t(z,{class:"music-footer",style:{"background-color":"rgb(177, 171, 171)"}},{default:s(()=>[t(Mt)]),_:1})]),_:1})}}});var Rt=U(Dt,[["__scopeId","data-v-40bd0dbe"]]);export{Rt as default};
